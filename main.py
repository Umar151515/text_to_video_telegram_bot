import asyncio

from utils.video.create import create_video_from_text


async def on_progress(event: str, data: dict | None):
    if event == "start":
        print("Video generation started.")
    elif event == "text_generated":
        print(f"\nText generated with image style: {data['image_style']}\nspeaker: {data['speaker']}\n\ngenerated text:\n{data["generated_text"]}\n.")
    elif event == "slide_done":
        print(f"\n\nSlide {data['index']} of {data['total']} done. Image prompt: {data['image_prompt']}")
    elif event == "video_created":
        print("\n\nVideo created successfully.")
    else:
        print(f"\n\nUnknown event: {event}")

asyncio.run(create_video_from_text(
    """"Николай Толстый: История одного веса

Николай Петрович Толстый родился в деревне Верхние Заносы в 1992 году, в семье тракториста и доярки. С малых лет он был плотным мальчиком, за что получил своё фамильное прозвище ещё до того, как научился ходить. Когда соседка баба Дуся впервые увидела младенца, она воскликнула:

— Ох, да он как булка хлеба с маслом! Толстый будет! — и с тех пор его так и звали: Николай Толстый.

Но вес был лишь внешней стороной его личности. Внутри Николай был человеком тонкой душевной организации, с философским складом ума и любовью к чтению. Пока другие деревенские мальчишки гоняли мяч, Николай сидел у окна и читал Платона, рассуждая про идеи и формы.

К 18 годам его вес перевалил за 160 килограммов, и родители, опасаясь за его здоровье, отправили его в город — мол, там и спорт, и врачи, и образование. Так он оказался в университете имени Фридриха Энгельса, на факультете «Физкультура и философия» (экспериментальное направление, закрытое через год).

Первое время Николай страдал: бегать он не любил, а преподаватели физкультуры требовали отжиматься, прыгать и даже карабкаться по канату. На философии же он преуспевал: его курсовая «Толстовство как метафизика телесного присутствия» получила признание и даже цитировалась в местной газете.

Но поворот в его судьбе произошёл в 2014 году, когда в студенческом буфете он познакомился с девушкой по имени Маруся Худаярова — будущей чемпионкой России по тяжёлой атлетике. Она подошла к нему и без тени стеснения сказала:

— Ты мощный. Мы с тобой могли бы поднять многое. В том числе и друг друга.

Так началась их великая любовь. Вместе они записались в секцию пауэрлифтинга. Николай открыл в себе звериную силу. Его первый подъём — 180 килограммов — сопровождался аплодисментами и одним обмороком тренера.

Прошло несколько лет. Николай стал чемпионом среди философов-тяжелоатлетов. Его прозвали «Живым тезисом»: когда он выходил на помост, философия становилась физической. Его речь на Международном философском конгрессе в 2021 году под названием «Я мыслю, следовательно, я жму» собрала аншлаг.

Однако славу он воспринимал философски. В интервью он как-то сказал:

    — Тело — это только сосуд. Но если сосуд крепкий, в нём можно держать даже истину.

С Маруся они поженились в 2022 году. На свадьбе они не танцевали — они соревновались, кто дольше удержит над головой гостей.

А в 2025 году Николай Толстый ушёл в монастырь. Не отрёкся от Маруси — они договорились, что тело принадлежит земле, а дух — Богу. Там он постригся в монахи и стал писать книгу под названием «Толстота духа».

Последний раз его видели в 2040 году на горе Афон. Он нёс мешок картошки и цитировал Аристотеля. С тех пор он исчез. Говорят, что он вознёсся, но другие — что он просто пошёл искать ещё более тяжёлую истину.""", 
on_progress=on_progress,
image_style="realism", 
speaker="mama.wav",
))